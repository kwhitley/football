{"version":3,"sources":["src/client/index.jsx","src/client/components/App.jsx","src/client/components/Collection/index.jsx","src/client/components/Collection/Grid.jsx","src/client/components/Collection/Item/index.jsx","src/client/components/Imager.jsx","src/client/hooks/index.js","src/client/hooks/collections.js","src/client/utils/index.js","src/client/utils/fetch.js","src/client/utils/misc.js","src/client/utils/validators.js","src/client/hooks/images.js","src/client/hooks/misc.js","src/client/hooks/store.js","src/client/hooks/user.js","src/client/hooks/user.actions.js","src/client/components/Page.jsx","src/client/components/Back.jsx","src/client/components/Collection/Item/Viewer.jsx","src/client/components/Collection/Item/Details.jsx","src/client/components/User/Login.jsx","src/client/components/Controls/Input.jsx","src/client/components/Collections/List.jsx","src/client/components/Collections/Create.jsx","src/client/components/User/UserActions.jsx"],"names":["react_1","$fsx","r","react_dom_1","App_1","default","render","createElement","document","getElementById","router_1","Collection_1","Viewer_1","Login_1","List_1","Create_1","UserActions_1","exports","className","Router","path","signup","primary","Grid_1","Page_1","hooks_1","collectionId","collection","isLoading","useCollectionDetails","name","items","classnames_1","Item_1","gridScale","undefined","length","map","item","index","key","id","Imager_1","Link","to","width","height","alt","Image","quality","params","push","src","useImageWithPreview","join","tslib_1","__exportStar","utils_1","useCollectionSlugIsAvailable","slug","isAvailable","setIsAvailable","useState","useEffect","fetchStatusIsOK","then","useCollections","collections","setCollections","setIsLoading","fetchJSON","setCollection","useItemDetails","itemId","setItem","console","warn","useNewCollection","setSlug","apiKey","setApiKey","isValid","withSlugifiedValue","fetchStatus","args","fetch","status","json","withValue","fn","target","value","toLowerCase","replace","validators","email","v","match","message","password","collectionName","previewPath","setSrc","onload","usePrevious","ref","useRef","log","current","GLOBALSTORAGE_PREFIX","Store","[object Object]","namespace","persist","this","setState","state","localStorage","JSON","stringify","setters","forEach","setter","parse","getItem","err","GlobalStore","set","options","hasOwnProperty","globalStore","window","useStore","whichStore","includes","filter","store_1","user_actions_1","isLoggedIn","profile","catch","useLogin","origin","login","setLogin","isValidating","error","setError","user","setUser","resetLogin","Object","assign","loginAction","logoutAction","onSuccess","requireLogin","location","navigate","pathname","passwordMessage","method","headers","Content-Type","body","success","Back_1","_a","children","visible","back","props","__rest","Back","onClick","Details_1","react_markings_1","story","Input_1","type","validator","onChange","valueOnly","label","placeholder","invalid","validationMessage","c","_id","createCollectionAction","disabled","Fragment"],"mappings":"8hBAAA,MAAAA,EAAAC,EAAAC,EAAA,IACAC,EAAAF,EAAAC,EAAA,IAEAE,EAAAH,EAAAC,EAAA,IAKAD,EAAAC,EAAA,IAEAC,EAAAE,QAASC,OAAON,EAAAK,QAAAE,cAACH,EAAAC,QAAG,MAAKG,SAASC,eAAe,gFCVjD,MAAAT,EAAAC,EAAAC,EAAA,IACAQ,EAAAT,EAAAC,EAAA,GAEAS,EAAAV,EAAAC,EAAA,IACAU,EAAAX,EAAAC,EAAA,IACAW,EAAAZ,EAAAC,EAAA,IACAY,EAAAb,EAAAC,EAAA,IACAa,EAAAd,EAAAC,EAAA,IAEAc,EAAAf,EAAAC,EAAA,IAoBAe,EAAAZ,QAlBY,KACVL,EAAAK,QAAAE,cAAA,OAAKW,UAAU,gBACblB,EAAAK,QAAAE,cAACG,EAAAS,QAAOD,UAAU,QAChBlB,EAAAK,QAAAE,cAACM,EAAAR,SAAMe,KAAK,SAASC,QAAM,IAC3BrB,EAAAK,QAAAE,cAACM,EAAAR,SAAMe,KAAK,UACZpB,EAAAK,QAAAE,cAACO,EAAAT,SAAgBe,KAAK,gBACtBpB,EAAAK,QAAAE,cAACQ,EAAAV,SAAiBe,KAAK,uBACvBpB,EAAAK,QAAAE,cAACI,EAAAN,SAAiBe,KAAK,kBACvBpB,EAAAK,QAAAE,cAACK,EAAAP,SAAWe,KAAK,0BACjBpB,EAAAK,QAAAE,cAACI,EAAAN,SAAiBe,KAAK,MACvBpB,EAAAK,QAAAE,cAAA,OAAKF,SAAO,GAAA,mBAGdL,EAAAK,QAAAE,cAACG,EAAAS,QAAOD,UAAU,WAAWI,SAAS,GACpCtB,EAAAK,QAAAE,cAACS,EAAAX,SAAYA,SAAO,+ECzB1B,MAAAL,EAAAC,EAAAC,EAAA,IACAqB,EAAAtB,EAAAC,EAAA,IACAsB,EAAAvB,EAAAC,EAAA,IACAuB,EAAAxB,EAAAC,EAAA,IAEAe,EAAAZ,QAAA,UAAwCqB,aAAEA,EAAe,cACvD,IAAIC,WAAEA,EAAAC,UAAYA,GAAcH,EAAAI,qBAAqBH,GAErD,SAAKC,GAAcC,IAKjB5B,EAAAK,QAAAE,cAACiB,EAAAnB,SAAKa,UAAU,cACdlB,EAAAK,QAAAE,cAAA,MAAIW,UAAU,oBAAqBS,EAAWG,MAE9C9B,EAAAK,QAAAE,cAACgB,EAAAlB,SAAKqB,aAAcA,EAAcK,MAAOJ,EAAWI,kFChB1D,MAAA/B,EAAAC,EAAAC,EAAA,IACA8B,EAAA/B,EAAAC,EAAA,GACA+B,EAAAhC,EAAAC,EAAA,IAEAe,EAAAZ,QAAA,UAA6BqB,aAAEA,EAAAK,MAAcA,IAC3C,IAAIG,OAAYC,EAUhB,OARIJ,EAAMK,OAAS,IACjBF,EAAY,QAGVH,EAAMK,OAAS,IACjBF,EAAY,OAIZlC,EAAAK,QAAAE,cAAA,OAAKW,UAAWc,EAAA3B,QAAW,OAAQ6B,IAE/BH,EAAMM,IAAI,CAACC,EAAMC,IACfvC,EAAAK,QAAAE,cAAC0B,EAAA5B,SACCmC,IAAKF,EAAKG,GACVA,GAAIf,EAAe,IAAMY,EAAKG,GAC9BH,KAAMA,+ECtBlB,MAAAtC,EAAAC,EAAAC,EAAA,IACAQ,EAAAT,EAAAC,EAAA,GACAwC,EAAAzC,EAAAC,EAAA,IAEAe,EAAAZ,QAAA,UAAiCiC,KAAEA,EAAAG,GAAMA,IACvC,OACEzC,EAAAK,QAAAE,cAAA,UAAA,KACEP,EAAAK,QAAAE,cAACG,EAAAiC,MAAKC,OAAQH,KACZzC,EAAAK,QAAAE,cAACmC,EAAArC,SACCoC,GAAIA,EACJI,MAAO,IACPC,OAAQ,IACRC,IAAKT,EAAKR,OAEZ9B,EAAAK,QAAAE,cAAA,QAAA,KAAOP,EAAAK,QAAAE,cAAA,OAAA,KAAQ+B,EAAKR,kFCd5B,MAAA9B,EAAAC,EAAAC,EAAA,IACAuB,EAAAxB,EAAAC,EAAA,IAEA,SAAwB8C,GAAMP,GAAEA,EAAAM,IAAIA,EAAAF,MAAKA,EAAAC,OAAOA,EAAAG,QAAQA,IACtD,MAAMC,KACFL,GAAOK,EAAOC,cAAcN,KAC5BC,GAAQI,EAAOC,eAAeL,KAC9BG,GAASC,EAAOC,gBAAgBF,KAEpC,MAAMG,EAAM3B,EAAA4B,0BAA0BZ,MAAOS,EAAOI,KAAK,YAEzD,OACEtD,EAAAK,QAAAE,cAAA,OAAK6C,IAAKA,EAAKL,IAAKA,IATxB9B,EAAAZ,QAAA2C,EAaA/B,EAAAZ,QAAe2C,0FChBfO,EAAAC,aAAAvD,EAAAC,EAAA,IAAAe,GACAsC,EAAAC,aAAAvD,EAAAC,EAAA,IAAAe,GACAsC,EAAAC,aAAAvD,EAAAC,EAAA,IAAAe,GACAsC,EAAAC,aAAAvD,EAAAC,EAAA,IAAAe,GACAsC,EAAAC,aAAAvD,EAAAC,EAAA,IAAAe,2ECJA,MAAAjB,EAAAC,EAAAC,EAAA,IACAuD,EAAAxD,EAAAC,EAAA,IA4BA,SAAgBwD,EAA6BC,GAC3C,IAAMC,EAAaC,GAAmB7D,EAAA8D,UAAS,GAW/C,OATA9D,EAAA+D,UAAU,KACR,GAAIJ,EAAKvB,OAAS,EAChB,OAAOyB,GAAe,GAGxBJ,EAAAO,oCAAoCL,eACjCM,KAAKJ,KACNF,IAEGC,EAhCT3C,EAAAiD,eAAA,WACE,IAAMC,EAAaC,GAAmBpE,EAAA8D,cAChClC,EAAWyC,GAAiBrE,EAAA8D,UAAS,GAY3C,OAVA9D,EAAA+D,UAAU,KACRM,GAAa,GAEbZ,EAAAa,UAAU,oBACPL,KAAK/D,IACJkE,EAAelE,GACfmE,GAAa,WAKjBF,YAAAA,EACAvC,UAAAA,IAIJX,EAAAyC,6BAAAA,EAeAzC,EAAAY,qBAAA,SAAqC8B,GACnC,IAAMhC,EAAY4C,GAAkBvE,EAAA8D,cAAS3B,IACvCP,EAAWyC,GAAiBrE,EAAA8D,UAAS,GAY3C,OAVA9D,EAAA+D,UAAU,KACRM,GAAa,GAEbZ,EAAAa,8BAA8BX,KAC3BM,KAAK/D,IACJmE,GAAa,GACbE,EAAcrE,OAEhByD,KAEKhC,WAAAA,EAAYC,UAAAA,IAGvBX,EAAAuD,eAAA,UAA+B9C,aAAEA,EAAA+C,OAAcA,IAC7C,IAAMnC,EAAMoC,GAAY1E,EAAA8D,cAAS3B,IAC3BP,EAAWyC,GAAiBrE,EAAA8D,UAAS,GAgB3C,OAdA9D,EAAA+D,UAAU,KACR,IAAKrC,IAAiB+C,EACpB,OAAOE,QAAQC,KAAK,+DAGtBP,GAAa,GAEbZ,EAAAa,8BAA8B5C,WAAsB+C,KACjDR,KAAK/D,IACJwE,EAAQxE,GACRmE,GAAa,OAEf3C,EAAc+C,KAETnC,KAAAA,EAAMV,UAAAA,IAGjBX,EAAA4D,iBAAA,WACE,IAAMlB,EAAMmB,GAAY9E,EAAA8D,SAAS,KAC3BiB,EAAQC,GAAchF,EAAA8D,SAAS,IAIrC,OACEiB,OAAAA,EACAC,UAAAA,EACArB,KAAAA,EACAsB,QAPgBvB,EAA6BC,GAQ7CmB,QAASrB,EAAAyB,mBAAmBJ,GAC5BlB,YAAaF,EAA6BC,6FC9F9CJ,EAAAC,aAAAvD,EAAAC,EAAA,IAAAe,GACAsC,EAAAC,aAAAvD,EAAAC,EAAA,IAAAe,GACAsC,EAAAC,aAAAvD,EAAAC,EAAA,IAAAe,0BCEA,SAAgBkE,KAAeC,GAC7B,OAAOC,SAASD,GAAMnB,KAAK/D,GAAKA,EAAEoF,yDALpCrE,EAAAqD,UAAA,YAA6Bc,GAC3B,OAAOC,SAASD,GAAMnB,KAAK/D,GAAKA,EAAEqF,SAGpCtE,EAAAkE,YAAAA,EAIAlE,EAAA+C,gBAAA,YAAmCoB,GACjC,OAAOD,KAAeC,GAAMnB,KAAK/D,GAAW,MAANA,4ECTxCe,EAAAuE,UAAA,SAA0BC,GACxB,MAAO,EAAGC,OAAAA,KAAaD,GAAK3D,KAAM4D,EAAO5D,KAAM6D,MAAOD,EAAOC,SAG/D1E,EAAAiE,mBAAA,SAAmCO,GACjC,OAAOE,GAAWF,EAAGE,EAAMC,cACFC,QAAQ,eAAgB,KACxBA,QAAQ,QAAS,+ECP/B5E,EAAA6E,YACXC,MAAO,MACLd,QAASe,GAAKA,EAAEC,MAAM,qBACtBC,QAAS,uCAEXC,SAAU,MACRlB,QAASe,GAAKA,EAAEC,MAAM,yCACtBC,QAAS,6HAGXE,eAAgBxC,KACdqB,QAAS,IAAMrB,EACfsC,QAAS,4HCZb,MAAAlG,EAAAC,EAAAC,EAAA,IAEAe,EAAAoC,oBAAA,SAAoCjC,GAClC,MAAMiF,EAAcjF,EAAKyE,QAAQ,qBAAsB,gBACvD,IAAMzC,EAAKkD,GAAWtG,EAAA8D,SAASuC,GAO/B,OALArG,EAAA+D,UAAU,MACI,IAAIf,OACVuD,OAASD,EAAOlF,KACpBA,IAEGgC,2ECXT,MAAApD,EAAAC,EAAAC,EAAA,IAEAe,EAAAuF,YAAA,SAA4Bb,GAC1B,MAAMc,EAAMzG,EAAA0G,SAOZ,OALA1G,EAAA+D,UAAU,KACRY,QAAQgC,IAAI,yBACZF,EAAIG,QAAUjB,IACZA,IAEGc,EAAIG,iFCVb,MAAA5G,EAAAC,EAAAC,EAAA,IAGM2G,EAAuB,qBAGhBC,EACXC,aAAYpB,MAAEA,EAAAqB,UAAOA,EAAAC,QAAWA,IAG9B,GAaFC,KAAAC,SAAWxB,CAAAA,IACTuB,KAAKE,MAAQzB,EACTuB,KAAKD,UACPtC,QAAQgC,IAAI,uBAAwBhB,EAAO,eAAgBkB,EAAuBG,GAClFK,aAAa3C,QAAQmC,EAAuBG,EAAWM,KAAKC,UAAU5B,KAExEuB,KAAKM,QAAQC,QAAQC,GAAUA,EAAOR,KAAKE,UArB3CF,KAAKE,MAAQzB,EAETsB,EACF,IACEC,KAAKE,MAAQE,KAAKK,MAAMN,aAAaO,QAAQf,EAAuBG,IACpErC,QAAQgC,IAAIE,EAAuBG,EAAW,oCAAqCE,KAAKE,OACxF,MAAMS,GACNlD,QAAQC,KAAKiC,EAAuBG,EAAW,wCAAyCE,KAAKE,OAGjGF,KAAKF,UAAYA,EACjBE,KAAKD,QAAUA,EACfC,KAAKM,YAdTvG,EAAA6F,MAAAA,QA4BagB,EAAbf,cACEG,KAAAa,IAAM,EAACf,EAAWrB,EAAOqC,QACvB,IAAIf,QAAEA,GAAYe,EACdd,KAAKe,eAAejB,GACtBE,KAAKF,GAAWG,SAASxB,GAEzBuB,KAAKF,GAAa,IAAIF,GAAQnB,MAAAA,EAAOsB,QAAAA,EAASD,UAAAA,MAIlDE,KAAAD,QAAU,KAAI7B,IAAS8B,KAAKa,OAAO3C,GAAQ6B,SAAS,MAVtDhG,EAAA6G,YAAAA,EAca7G,EAAAiH,YAAcC,OAAOD,YAAc,IAAIJ,EAGpD7G,EAAAmH,SAAA,SAAyBpB,EAAWrB,EAAOqC,MACzC,IAAIK,OAAalG,GACb8E,QAAEA,GAAYe,EAGhBK,EADEpH,EAAAiH,YAAYD,eAAejB,GAChB/F,EAAAiH,YAAYlB,GAEZ/F,EAAAiH,YAAYlB,GAAa,IAAIF,GAAQnB,MAAAA,EAAOsB,QAAAA,EAASD,UAAAA,IAGpE,MAAQI,EAAOW,GAAQ/H,EAAA8D,SAASuE,EAAWjB,OAU3C,OARKiB,EAAWb,QAAQc,SAASP,IAC/BM,EAAWb,QAAQrE,KAAK4E,GAG1B/H,EAAA+D,UAAU,IAAM,KACdsE,EAAWb,QAAUa,EAAWb,QAAQe,OAAOb,GAAUA,IAAWK,SAG7DX,EAAOiB,EAAWlB,mFCvE7B,MAAAnH,EAAAC,EAAAC,EAAA,IACAsI,EAAAvI,EAAAC,EAAA,IACAuI,EAAAxI,EAAAC,EAAA,IACAuD,EAAAxD,EAAAC,EAAA,IACAQ,EAAAT,EAAAC,EAAA,GAEAsI,EAAAN,YAAYjB,QAAQ,QAAUyB,YAAY,IAE1CjF,EAAAa,UAAU,iBACPL,KAAK0E,IACJhE,QAAQgC,IAAI,mBACZ6B,EAAAN,YAAYH,IAAI,QAAUW,YAAY,EAAMC,QAAAA,MAE7CC,MAAM,KACLjE,QAAQC,KAAK,mCACb4D,EAAAN,YAAYH,IAAI,QAAUW,YAAY,EAAOC,aAASxG,MAG1DlB,EAAA4H,SAAA,SAAyBC,GACvB,IAAMC,EAAOC,GAAahJ,EAAA8D,UACxBiC,MAAO,GACPI,SAAU,GACV8C,cAAc,KAEVC,EAAOC,GAAanJ,EAAA8D,cAAS3B,IAC7BiH,EAAMC,GAAYb,EAAAJ,SAAS,QAC7BkB,EAAa,KACfH,IACAH,GAAWjD,MAAO,GAAII,SAAU,GAAI8C,cAAc,KAGpD,OACEF,MAAAA,EACAK,KAAAA,EACAF,MAAAA,EACAF,SAAU,EAAGlH,KAAAA,EAAM6D,MAAAA,KAAYqD,EAAQO,OAAAC,UAAMT,GAAOhC,CAACjF,GAAO6D,KAC5D8D,YAAa,KACXhB,EAAAgB,aAAcV,MAAAA,EAAOO,WAAAA,EAAYD,QAAAA,EAASF,SAAAA,EAAUL,OAAAA,KAEtDY,aAAc,KACZ/E,QAAQgC,IAAI,eACZ8B,EAAAiB,cACEC,UAAW,IAAMN,GAAUX,YAAY,EAAOC,aAASxG,SAM/DlB,EAAA2I,aAAA,SAA6BC,GAC3B,IAAMT,GAASZ,EAAAJ,SAAS,QAOxB,OALKgB,EAAKV,aACR/D,QAAQgC,IAAI,qBAAsByC,EAAM,wBACxC1I,EAAAoJ,SAAS,UAAY1C,OAAS0B,OAAQe,EAASE,UAAYlE,SAAS,KAG/DuD,EAAKV,oFCxDd,MAAAjF,EAAAxD,EAAAC,EAAA,IACAQ,EAAAT,EAAAC,EAAA,GAEae,EAAAwI,YAAc,GAAGV,MAAAA,EAAOO,WAAAA,EAAYD,QAAAA,EAASF,SAAAA,EAAUL,OAAAA,MAClE,IAAI7D,QACFA,EACAiB,QAAS8D,GACPvG,EAAAqC,WAAWK,WAEf,OAAK4C,EAAMhD,OAAUgD,EAAM5C,SAItBlB,EAAQ8D,EAAM5C,eAInB1C,EAAAa,UAAU,eAEN2F,OAAQ,OACRC,SACEC,eAAgB,oBAElBC,KAAM9C,KAAKC,UAAUwB,KAEtB9E,KAAK0E,IACJhE,QAAQgC,IAAI,gBAAiBgC,EAASG,GAEtCO,GACEX,YAAY,EACZC,QAAAA,IAGFQ,IAEAG,GAAcA,IAEVR,IACFnE,QAAQgC,IAAI,eAAgBmC,GAC5BpI,EAAAoJ,SAAShB,MAGZF,MAAM,KACLS,GAAUV,aAASxG,EAAWuG,YAAY,IAC1CS,EAAS,gEA9BJA,EAASa,GAJTb,EAAS,gDAsCPlI,EAAAyI,aAAe,GAAGC,UAAAA,MAC7BlG,EAAAO,gBAAgB,gBACbC,KAAKoG,GAAWA,EAAUV,IAAchF,QAAQC,KAAK,+GClD1D5E,EAAAC,EAAAC,EAAA,IACA8B,EAAA/B,EAAAC,EAAA,GACAoK,EAAArK,EAAAC,EAAA,IAEAe,EAAAZ,QAAekK,CAAAA,QAACC,SAAEA,EAAAC,QAAUA,GAAU,EAAAvJ,UAAMA,EAAAwJ,KAAWA,GAAIH,EAAEI,EAAApH,EAAAqH,OAAAL,GAAA,WAAA,UAAA,YAAA,SAC3D,OACEvK,EAAAK,QAAAE,cAAA,OAAKW,UAAWc,EAAA3B,QAAW,OAAQa,IAC/BwJ,GAAQ1K,EAAAK,QAAAE,cAAC+J,EAAAjK,QAAIkJ,OAAAC,UAAKmB,IAClBF,GAAWD,6ECRnB,MAAAxK,EAAAC,EAAAC,EAAA,IAEae,EAAA4J,KAAO,GAAGf,SAAAA,EAAUlH,GAAAA,EAAK,UAEpC,OAAO5C,EAAAK,QAAAE,cAAA,OAAKW,UAAU,OAAO4J,QADd,IAAMhB,EAASlH,OAIhC3B,EAAAZ,QAAeY,EAAA4J,6ECPf,MAAA7K,EAAAC,EAAAC,EAAA,IACAwC,EAAAzC,EAAAC,EAAA,IACA6K,EAAA9K,EAAAC,EAAA,IACAsB,EAAAvB,EAAAC,EAAA,IACAuB,EAAAxB,EAAAC,EAAA,IAGAe,EAAAZ,QAAA,UAAmCqB,aAAEA,EAAA+C,OAAcA,EAAAqF,SAAQA,IACzD,IAAIxH,KAAEA,EAAAV,UAAMA,GAAcH,EAAA+C,gBAAiB9C,aAAAA,EAAc+C,OAAAA,IAEzD,SAAKnC,GAAQV,IAKX5B,EAAAK,QAAAE,cAACiB,EAAAnB,SAAKqK,MAAI,EAACxJ,UAAU,SAAS4I,SAAUA,GACtC9J,EAAAK,QAAAE,cAACmC,EAAArC,SACCoC,GAAIf,EAAe,IAAMY,EAAKG,GAC9BI,MAAO,MAET7C,EAAAK,QAAAE,cAACwK,EAAA1K,SAAQiC,KAAMA,8ECpBrB,MAAAtC,EAAAC,EAAAC,EAAA,IACA8K,EAAA/K,EAAAC,EAAA,IAGAe,EAAAZ,QAAA,UAAqCiC,KAAEA,IACrC,OACEtC,EAAAK,QAAAE,cAAA,OAAKW,UAAU,iBACblB,EAAAK,QAAAE,cAAA,KAAA,KAAM+B,EAAKR,MACX9B,EAAAK,QAAAE,cAAA,OAAKW,UAAU,SACX8J,EAAA3K,SAAIiC,EAAK2I,mFCTnB,MAAAjL,EAAAC,EAAAC,EAAA,IACAQ,EAAAT,EAAAC,EAAA,GACAsB,EAAAvB,EAAAC,EAAA,IAEAgL,EAAAjL,EAAAC,EAAA,IACAuD,EAAAxD,EAAAC,EAAA,IACAuB,EAAAxB,EAAAC,EAAA,IAWAe,EAAAZ,QAAA,UAA8BwJ,SAAEA,EAAAxI,OAAUA,GAAS,IACjDsD,QAAQgC,IAAI,SACZ,IAAImC,EAASe,EAASzC,OAASyC,EAASzC,MAAM0B,aAAU3G,GACpD4G,MAAEA,EAAAC,SAAOA,EAAAE,MAAUA,EAAAO,YAAOA,EAAAC,aAAaA,GAAiBjI,EAAAoH,SAASC,IAC/DM,GAAS3H,EAAA2G,SAAS,QAkBxB,OAhBAzD,QAAQgC,KACNmC,OAAAA,EACAM,KAAAA,EACAL,MAAAA,IAGF/I,EAAA+D,UACE,KACEY,QAAQgC,IAAI,kBAAmByC,GAC3BA,EAAKV,aACP/D,QAAQgC,IAAI,yCAA0CmC,EAAQe,GAC9DnJ,EAAAoJ,SAAShB,GAAU,QAEnBC,EAAOK,IAIXpJ,EAAAK,QAAAE,cAACiB,EAAAnB,SAAKa,UAAU,QACdlB,EAAAK,QAAAE,cAAA,KAAA,KAAMc,EAAS,UAAY,SAE3BrB,EAAAK,QAAAE,cAAC2K,EAAA7K,SACCyB,KAAK,QACLqJ,KAAK,QACLxF,MAAOoD,EAAMhD,MACbqF,UAAW3H,EAAAqC,WAAWC,QACtBsF,SAAUrC,IAGZhJ,EAAAK,QAAAE,cAAC2K,EAAA7K,SACCyB,KAAK,WACLqJ,KAAK,WACLxF,MAAOoD,EAAM5C,SACbkF,SAAUrC,EACVoC,UAAW3H,EAAAqC,WAAWK,aAGpB+C,GAASlJ,EAAAK,QAAAE,cAAA,OAAKW,UAAU,SAASgI,GAErClJ,EAAAK,QAAAE,cAAA,UAAQuK,QAASrB,GAAW,oGC7DlCzJ,EAAAC,EAAAC,EAAA,IACA8B,EAAA/B,EAAAC,EAAA,GAEMoL,EAAY7F,GAAQ,EAAGC,OAAAA,MAC3B,IAAI5D,KAAEA,EAAA6D,MAAMA,GAAUD,EAEtB,OACSD,EADL3D,EACQ4D,EAEAC,IAId1E,EAAAZ,QAAA,SAA8BkK,OAAAzI,KAC5BA,EAAA6D,MACAA,EAAA0F,SACAA,EAAAE,MACAA,EAAAC,YACAA,EAAAtK,UACAA,EAAAkK,UACAA,GAASb,EACTI,EAAApH,EAAAqH,OAAAL,GAAA,OAAA,QAAA,WAAA,QAAA,cAAA,YAAA,cAEA,IAAIkB,OAAUtJ,EACVuJ,OAAoBvJ,EAOxB,OALIiJ,IAEFM,GADAD,EAAUL,EAAUnG,QAAQU,QAASxD,EAAY,SAClBwD,GAASyF,EAAUlF,SAIlDlG,EAAAK,QAAAE,cAAA,WAASW,UAAU,eACjBlB,EAAAK,QAAAE,cAAA,QAAAgJ,OAAAC,QACEtI,UAAWc,EAAA3B,QAAW,QAASa,GAC/BiK,KAAK,OACLrJ,KAAMA,EACN6D,MAAOA,EACP8F,QAASA,EACTD,YAAaA,GAAe1J,EAC5BuJ,SAAUC,EAAUD,IAChBV,IAEN3K,EAAAK,QAAAE,cAAA,SAAOW,UAAWwK,EAAoB,YAASvJ,GAAaoJ,GAASC,GAAe1J,GAElFsJ,GAAaA,EAAUlF,SACvBlG,EAAAK,QAAAE,cAAA,KAAGW,UAAWc,EAAA3B,QAAW,UAAWqL,GAAqB,YACrDA,6EC/CZ,MAAA1L,EAAAC,EAAAC,EAAA,IACAQ,EAAAT,EAAAC,EAAA,GAEAsB,EAAAvB,EAAAC,EAAA,IACAuB,EAAAxB,EAAAC,EAAA,IAEAe,EAAAZ,QAAA,UAAwCwJ,SAAEA,IACxC,IAAInB,EAAajH,EAAAmI,aAAaC,IACxBT,GAAS3H,EAAA2G,SAAS,QAExB,IAAKM,EACH,OAAO,EAGT,IAAIvE,YAAEA,GAAgBiF,EAAKT,QAE3B,OACE3I,EAAAK,QAAAE,cAACiB,EAAAnB,SAAKa,UAAU,yBACdlB,EAAAK,QAAAE,cAAA,KAAA,KAAA,eAEE4D,EAAY9B,IAAIsJ,GACd3L,EAAAK,QAAAE,cAACG,EAAAiC,MACCH,IAAKmJ,EAAEC,IACPhJ,GAAI,IAAM+I,EAAEhI,MAEVgI,EAAE7J,MAAQ6J,EAAEhI,OAIpB3D,EAAAK,QAAAE,cAACG,EAAAiC,MAAKzB,UAAU,SAAS0B,GAAG,UAAQ,wFC7B1C,MAAA5C,EAAAC,EAAAC,EAAA,IAEAsB,EAAAvB,EAAAC,EAAA,IACAgL,EAAAjL,EAAAC,EAAA,IAGAuD,EAAAxD,EAAAC,EAAA,IACAuB,EAAAxB,EAAAC,EAAA,IAEAe,EAAAZ,QAAA,UAAyCwJ,SAAEA,IACzC,IAAInB,EAAajH,EAAAmI,aAAaC,GAC1BlI,EAAaF,EAAAoD,oBACblB,KACFA,EAAAmB,QACAA,EAAAC,OACAA,EAAAC,UACAA,EAAApB,YACAA,EAAAqB,QACAA,EAAA4G,uBACAA,GACElK,EAEJ,QAAK+G,GAKH1I,EAAAK,QAAAE,cAACiB,EAAAnB,SAAKa,UAAU,OAAOuJ,QAAS/B,GAC9B1I,EAAAK,QAAAE,cAAA,KAAA,KAAA,2BAEAP,EAAAK,QAAAE,cAAC2K,EAAA7K,SACCmL,YAAY,wBACZ7F,MAAOhC,EACPyH,UAAW3H,EAAAqC,WAAWM,eAAexC,GACrCyH,SAAUvG,IAGZ9E,EAAAK,QAAAE,cAAC2K,EAAA7K,SACCmL,YAAY,eACZ7F,MAAOZ,EACPsG,SAAUrG,IAGZhF,EAAAK,QAAAE,cAAA,UACEuL,UAAW7G,EACX6F,QAASe,GAAsB,+FC7CvC,MAAA7L,EAAAC,EAAAC,EAAA,IACAQ,EAAAT,EAAAC,EAAA,GACAuB,EAAAxB,EAAAC,EAAA,IAEAe,EAAAZ,QAAA,UAAoCwJ,SAAEA,IACpC,IACIT,KAAEA,EAAAM,aAAMA,GAAiBjI,EAAAoH,WAE7B,OAHagB,GAAYA,EAASzC,OAASyC,EAASzC,MAAM0B,OAIxD9I,EAAAK,QAAAE,cAACP,EAAAK,QAAM0L,SAAQ,KAEX3C,EAAKV,WACH1I,EAAAK,QAAAE,cAACP,EAAAK,QAAM0L,SAAQ,KACb/L,EAAAK,QAAAE,cAAA,KAAGW,UAAU,OAAO4J,QAASpB,GAAY,UACzC1J,EAAAK,QAAAE,cAACG,EAAAiC,MAAKC,GAAG,gBAAc,gBAEzB5C,EAAAK,QAAAE,cAAA,OAAKW,UAAU,gBACblB,EAAAK,QAAAE,cAAA,KACEW,UAAU,OACV4J,QAAS,IACPpK,EAAAoJ,SAAS,UAEL1C,OACE0B,OAAQe,GAAYA,EAASE,UAE/BlE,SAAS,KAEZ,SAEL7F,EAAAK,QAAAE,cAACG,EAAAiC,MAAKC,GAAG,WAAS","sourcesContent":["import React, { h } from 'react'\nimport ReactDom from 'react-dom'\n\nimport App from './components/App'\n// import store from './state'\n// import './utils/zoomfix'\n\n// styles\nimport './styles/base.scss'\n\nReactDom.render(<App />, document.getElementById('app'))\n","import React from 'react'\nimport { Router } from '@reach/router'\n\nimport CollectionViewer from './Collection'\nimport ItemViewer from './Collection/Item/Viewer'\nimport Login from './User/Login'\nimport CollectionsList from './Collections/List'\nimport CreateCollection from './Collections/Create'\nimport Back from './Back'\nimport UserActions from './User/UserActions'\n\nconst App = () =>\n  <div className=\"page-content\">\n    <Router className=\"main\">\n      <Login path=\"signup\" signup />\n      <Login path=\"login\" />\n      <CollectionsList path=\"collections\" />\n      <CreateCollection path=\"collections/create\" />\n      <CollectionViewer path=\":collectionId\" />\n      <ItemViewer path=\":collectionId/:itemId\" />\n      <CollectionViewer path=\"/\" />\n      <div default>Page not found</div>\n    </Router>\n\n    <Router className=\"controls\" primary={false}>\n      <UserActions default />\n    </Router>\n  </div>\n\nexport default App\n","import React from 'react'\nimport Grid from './Grid'\nimport Page from '../Page'\nimport { useCollectionDetails } from '../../hooks'\n\nexport default function ImageCollection({ collectionId = 'krwhitley' }) {\n  let { collection, isLoading } = useCollectionDetails(collectionId)\n\n  if (!collection || isLoading) {\n    return false\n  }\n\n  return (\n    <Page className=\"collection\">\n      <h1 className=\"collection-title\">{ collection.name }</h1>\n\n      <Grid collectionId={collectionId} items={collection.items} />\n    </Page>\n  )\n}\n\n// export default ImageCollection\n//inject('app', 'user', 'collection', 'scroll')(observer(ImageCollection))\n\n// componentWillUnmount() {\n  //   this.props.scroll.isTracking = false\n  //   window.scrollTo(0, 0)\n  // }\n\n  // componentDidMount() {\n  //   console.log('ImageCollection:props', this.props)\n  //   let { collection, collectionId, scroll } = this.props\n\n  //   scroll.restore()\n  //   scroll.isTracking = true\n  //   collection.load(collectionId || 'krwhitley')\n  // }\n\n  // componentDidUpdate(prev) {\n  //   let { collectionId, collection } = this.props\n\n  //   if (collectionId !== prev.collectionId) {\n  //     collection.load(collectionId || 'krwhitley')\n  //   }\n  // }\n\n  // return() {\n  //   let { app, user, collection, navigate } = this.props\n  //   console.log('CollectionIndex', collection)\n\n  //   return (\n  //     <Page className=\"collection\">\n  //       {\n  //         app.editMode && user.isLoggedIn\n  //         ? <div className=\"edit-collection-details\">\n  //             <LiveEdit\n  //               className=\"h1 collection-title\"\n  //               value={collection.name}\n  //               onChange={collection.set('name')}\n  //               placeholder=\"Gallery Title\"\n  //             />\n\n  //             {\n  //               collection.isDirty && <button\n  //                 className=\"save\"\n  //                 onClick={collection.save}\n  //                 >\n  //                 Save Changes\n  //               </button>\n  //             }\n  //           </div>\n  //         : <h1 className=\"collection-title\">{ collection.name }</h1>\n  //       }\n  //       <Grid />\n  //     </Page>\n  //   )\n  // }\n","import React from 'react'\nimport classNames from 'classnames'\nimport Item from './Item'\n\nexport default function Grid({ collectionId, items }) {\n  let gridScale = undefined\n\n  if (items.length < 8) {\n    gridScale = 'some'\n  }\n\n  if (items.length < 4) {\n    gridScale = 'few'\n  }\n\n  return (\n    <div className={classNames('grid', gridScale)}>\n      {\n        items.map((item, index) =>\n          <Item\n            key={item.id}\n            id={collectionId + '/' + item.id}\n            item={item}\n            />\n        )\n      }\n    </div>\n  )\n}\n","import React from 'react'\nimport { Link } from '@reach/router'\nimport Imager from '../../Imager'\n\nexport default function GridItem({ item, id }) {\n  return (\n    <article>\n      <Link to={`/${id}`}>\n        <Imager\n          id={id}\n          width={400}\n          height={400}\n          alt={item.name}\n          />\n        <label><span>{ item.name }</span></label>\n      </Link>\n    </article>\n  )\n}\n","import React, { Component } from 'react'\nimport { useImageWithPreview } from '../hooks'\n\nexport default function Image({ id, alt, width, height, quality }) {\n  const params = []\n  if (width) params.push(`width=${width}`)\n  if (height) params.push(`height=${height}`)\n  if (quality) params.push(`quality=${quality}`)\n\n  const src = useImageWithPreview(`/i/${id}::${params.join(',')}.jpg`)\n\n  return (\n    <img src={src} alt={alt} />\n  )\n}\n\nexport default Image\n","export * from './collections'\nexport * from './images'\nexport * from './misc'\nexport * from './store'\nexport * from './user'\n","import { useState, useEffect } from 'react'\nimport {\n  fetchJSON,\n  fetchStatusIsOK,\n  withValue,\n  withSlugifiedValue,\n  validators,\n} from '../utils'\n\nexport function useCollections() {\n  let [ collections, setCollections ] = useState([])\n  let [ isLoading, setIsLoading ] = useState(false)\n\n  useEffect(() => {\n    setIsLoading(true)\n\n    fetchJSON('/api/collections')\n      .then(r => {\n        setCollections(r)\n        setIsLoading(false)\n      })\n  }, [])\n\n  return {\n    collections,\n    isLoading,\n  }\n}\n\nexport function useCollectionSlugIsAvailable(slug) {\n  let [ isAvailable, setIsAvailable ] = useState(false)\n\n  useEffect(() => {\n    if (slug.length < 5) {\n      return setIsAvailable(false)\n    }\n\n    fetchStatusIsOK(`/api/collections/${slug}/available`)\n      .then(setIsAvailable)\n  }, [slug])\n\n  return isAvailable\n}\n\nexport function useCollectionDetails(slug) {\n  let [ collection, setCollection ] = useState(undefined)\n  let [ isLoading, setIsLoading ] = useState(false)\n\n  useEffect(() => {\n    setIsLoading(true)\n\n    fetchJSON(`/api/collections/${slug}`)\n      .then(r => {\n        setIsLoading(false)\n        setCollection(r)\n      })\n  }, [slug])\n\n  return { collection, isLoading }\n}\n\nexport function useItemDetails({ collectionId, itemId }) {\n  let [ item, setItem ] = useState(undefined)\n  let [ isLoading, setIsLoading ] = useState(false)\n\n  useEffect(() => {\n    if (!collectionId || !itemId) {\n      return console.warn('attempting to useItemDetails without collectionId or itemId')\n    }\n\n    setIsLoading(true)\n\n    fetchJSON(`/api/collections/${collectionId}/items/${itemId}`)\n      .then(r => {\n        setItem(r)\n        setIsLoading(false)\n      })\n  }, [collectionId, itemId])\n\n  return { item, isLoading }\n}\n\nexport function useNewCollection() {\n  let [ slug, setSlug ] = useState('')\n  let [ apiKey, setApiKey ] = useState('')\n  let isAvailable = useCollectionSlugIsAvailable(slug)\n  let isValid = isAvailable\n\n  return {\n    apiKey,\n    setApiKey,\n    slug,\n    isValid,\n    setSlug: withSlugifiedValue(setSlug),\n    isAvailable: useCollectionSlugIsAvailable(slug),\n  }\n}\n","export * from './fetch'\nexport * from './misc'\nexport * from './validators'\n","export function fetchJSON(...args) {\n  return fetch(...args).then(r => r.json())\n}\n\nexport function fetchStatus(...args) {\n  return fetch(...args).then(r => r.status)\n}\n\nexport function fetchStatusIsOK(...args) {\n  return fetchStatus(...args).then(r => r === 200)\n}\n","export function withValue(fn) {\n  return ({ target }) => fn({ name: target.name, value: target.value })\n}\n\nexport function withSlugifiedValue(fn) {\n  return (value) => fn(value.toLowerCase()\n                          .replace(/[^\\w\\.\\-_]/gi, '-')\n                          .replace(/\\-+/gi, '-')\n                      )\n}\n","export const validators = {\n  email: () => ({\n    isValid: v => v.match(/^.+@.{2,}\\..{2,}$/),\n    message: `Please enter a valid email address`,\n  }),\n  password: () => ({\n    isValid: v => v.match(/^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/),\n    message: `Passwords should be at least 8 characters, include capital\n              and lowercase letters, and at least one number`,\n  }),\n  collectionName: (isAvailable) => ({\n    isValid: () => isAvailable,\n    message: 'This name is invalid or has already been taken',\n  })\n}\n","import { useState, useEffect } from 'react'\n\nexport function useImageWithPreview(path) {\n  const previewPath = path.replace(/^(.*)(\\.jpg|png)$/i, '$1,preview$2')\n  let [ src, setSrc ] = useState(previewPath)\n\n  useEffect(() => {\n    let image = new Image()\n    image.onload = setSrc(path)\n  }, [path])\n\n  return src\n}\n","import { useState, useRef, useEffect } from 'react'\n\nexport function usePrevious(value) {\n  const ref = useRef()\n\n  useEffect(() => {\n    console.log('usePrevious:useEffect')\n    ref.current = value\n  }, [value])\n\n  return ref.current\n}\n","import { useState, useEffect } from 'react'\n\n// prefix for localStorage\nconst GLOBALSTORAGE_PREFIX = 'globalstore:'\n\n// individual Store implementation for tracking values/setters\nexport class Store {\n  constructor({ value, namespace, persist }) {\n    this.state = value\n\n    if (persist) {\n      try {\n        this.state = JSON.parse(localStorage.getItem(GLOBALSTORAGE_PREFIX + namespace))\n        console.log(GLOBALSTORAGE_PREFIX + namespace, 'found in localStorage, setting to', this.state)\n      } catch(err) {\n        console.warn(GLOBALSTORAGE_PREFIX + namespace, 'not found in localStorage, setting to', this.state)\n      }\n    }\n    this.namespace = namespace\n    this.persist = persist\n    this.setters = []\n  }\n\n  setState = (value) => {\n    this.state = value\n    if (this.persist) {\n      console.log('should persist value', value, 'to namespace', GLOBALSTORAGE_PREFIX + namespace)\n      localStorage.setItem(GLOBALSTORAGE_PREFIX + namespace, JSON.stringify(value))\n    }\n    this.setters.forEach(setter => setter(this.state))\n  }\n}\n\n// namespaced index of requested Stores\nexport class GlobalStore {\n  set = (namespace, value, options = {}) => {\n    let { persist } = options\n    if (this.hasOwnProperty(namespace)) {\n      this[namespace].setState(value)\n    } else {\n      this[namespace] = new Store({ value, persist, namespace })\n    }\n  }\n\n  persist = (...args) => this.set(...args, { persist: true })\n}\n\n// shared instantiation of GlobalStore\nexport const globalStore = window.globalStore = new GlobalStore()\n\n// the actual hook\nexport function useStore(namespace, value, options = {}) {\n  let whichStore = undefined\n  let { persist } = options\n\n  if (globalStore.hasOwnProperty(namespace)) {\n    whichStore = globalStore[namespace]\n  } else {\n    whichStore = globalStore[namespace] = new Store({ value, persist, namespace })\n  }\n\n  const [ state, set ] = useState(whichStore.state)\n\n  if (!whichStore.setters.includes(set)) {\n    whichStore.setters.push(set)\n  }\n\n  useEffect(() => () => {\n    whichStore.setters = whichStore.setters.filter(setter => setter !== set)\n  }, [])\n\n  return [ state, whichStore.setState ]\n}\n","import { useState, useEffect } from 'react'\nimport { globalStore, useStore } from './store'\nimport { loginAction, logoutAction } from './user.actions'\nimport { fetchJSON } from '../utils'\nimport { navigate } from '@reach/router'\n\nglobalStore.persist('user', { isLoggedIn: true })\n\nfetchJSON('/user/profile')\n  .then(profile => {\n    console.log('profile fetched')\n    globalStore.set('user', { isLoggedIn: true, profile })\n  })\n  .catch(() => {\n    console.warn('user profile could not be found')\n    globalStore.set('user', { isLoggedIn: false, profile: undefined })\n  })\n\nexport function useLogin(origin) {\n  let [ login, setLogin ] = useState({\n    email: '',\n    password: '',\n    isValidating: false,\n  })\n  let [ error, setError ] = useState(undefined)\n  let [ user, setUser ] = useStore('user')\n  let resetLogin = () => {\n    setError()\n    setLogin({ email: '', password: '', isValidating: false })\n  }\n\n  return {\n    login,\n    user,\n    error,\n    setLogin: ({ name, value }) => setLogin({ ...login, [name]: value }),\n    loginAction: () => {\n      loginAction({ login, resetLogin, setUser, setError, origin })\n    },\n    logoutAction: () => {\n      console.log('logging out')\n      logoutAction({\n        onSuccess: () => setUser({ isLoggedIn: false, profile: undefined })\n      })\n    }\n  }\n}\n\nexport function requireLogin(location) {\n  let [ user ] = useStore('user')\n\n  if (!user.isLoggedIn) {\n    console.log('user not logged in', user, 'redirecting to login')\n    navigate('/login', { state: { origin: location.pathname }, replace: true })\n  }\n\n  return user.isLoggedIn\n}\n","import { validators, fetchJSON, fetchStatusIsOK } from '../utils'\nimport { navigate } from '@reach/router'\n\nexport const loginAction = ({ login, resetLogin, setUser, setError, origin }) => {\n  let {\n    isValid,\n    message: passwordMessage,\n  } = validators.password()\n\n  if (!login.email || !login.password) {\n    return setError('You need a username and password to login.')\n  }\n\n  if (!isValid(login.password)) {\n    return setError(passwordMessage)\n  }\n\n  fetchJSON('/user/login',\n    {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(login),\n    })\n    .then(profile => {\n      console.log('login success', profile, origin)\n\n      setUser({\n        isLoggedIn: true,\n        profile,\n      })\n\n      setError()\n\n      resetLogin && resetLogin()\n\n      if (origin) {\n        console.log('returning to', origin)\n        navigate(origin)\n      }\n    })\n    .catch(() => {\n      setUser({ profile: undefined, isLoggedIn: false })\n      setError('Are you sure about that username and password?  Try again!')\n    })\n}\n\nexport const logoutAction = ({ onSuccess }) => {\n  fetchStatusIsOK('/user/logout')\n    .then(success => success ? onSuccess() : console.warn('unable to logout'))\n}\n","import React from 'react'\nimport classNames from 'classnames'\nimport Back from './Back'\n\nexport default ({ children, visible = true, className, back, ...props }) => {\n  return (\n    <div className={classNames('page', className)}>\n      { back && <Back {...props} /> }\n      { visible && children }\n    </div>\n  )\n}\n","import React from 'react'\n\nexport const Back = ({ navigate, to = '../' }) => {\n  const goBack = () => navigate(to)\n  return <div className=\"back\" onClick={goBack} />\n}\n\nexport default Back\n","import React from 'react'\nimport Imager from '../../Imager'\nimport Details from './Details'\nimport Page from '../../Page'\nimport { useItemDetails } from '../../../hooks'\nimport Inspect from '../../Controls/Inspect'\n\nexport default function ItemViewer({ collectionId, itemId, navigate }) {\n  let { item, isLoading } = useItemDetails({ collectionId, itemId })\n\n  if (!item || isLoading) {\n    return false\n  }\n\n  return (\n    <Page back className=\"viewer\" navigate={navigate}>\n      <Imager\n        id={collectionId + '/' + item.id}\n        width={900}\n        />\n      <Details item={item} />\n    </Page>\n  )\n}\n","import React from 'react'\nimport md from 'react-markings'\n// import LiveEdit from '../../Controls/LiveEdit'\n\nexport default function ImageDetails({ item }) {\n  return (\n    <div className=\"image-details\">\n      <h1>{ item.name }</h1>\n      <div className=\"story\">\n        { md([item.story]) }\n      </div>\n    </div>\n  )\n}\n\n  // <div className=\"image-details\">\n  //     {\n  //       app.editMode\n  //       ? <LiveEdit\n  //           className=\"h1 title\"\n  //           value={image.name}\n  //           onChange={image.set('name')}\n  //           placeholder=\"Give the image a title\"\n  //           />\n  //       : <h1>{ image.name }</h1>\n  //     }\n\n  //     {\n  //       app.editMode\n  //       ? <LiveEdit\n  //           className=\"story\"\n  //           value={image.story}\n  //           onChange={image.set('story')}\n  //           placeholder=\"Tell the story\"\n  //           />\n  //       : <div className=\"story\">\n  //           { md([image.story]) }\n  //         </div>\n  //     }\n\n  //     {\n  //       app.editMode && image.isDirty\n  //       ? <button\n  //           className=\"save\"\n  //           onClick={image.save}\n  //           >\n  //           Save Changes\n  //         </button>\n  //       : null\n  //     }\n  //   </div>\n  // )\n","import React, { useState, useRef, useEffect } from 'react'\nimport { navigate } from '@reach/router'\nimport Page from '../Page'\nimport LoginForm from './LoginForm'\nimport Input from '../Controls/Input'\nimport { validators } from '../../utils'\nimport {\n  usePrevious,\n  useCollections,\n  useCollectionSlugIsAvailable,\n  useCollectionDetails,\n  useNewCollection,\n  useLogin,\n  useStore,\n  globalStore,\n} from '../../hooks'\n\nexport default function Login({ location, signup = false }){\n  console.log('Login')\n  let origin = location.state && location.state.origin || undefined\n  let { login, setLogin, error, loginAction, logoutAction } = useLogin(origin)\n  let [ user ] = useStore('user')\n\n  console.log({\n    origin,\n    user,\n    login,\n  })\n\n  useEffect(\n    () => {\n      console.log('Login:useEffect', user)\n      if (user.isLoggedIn) {\n        console.log('user already logged in, redirecting to', origin, location)\n        navigate(origin || '/')\n      }\n    }, [login, user]\n  )\n\n  return (\n    <Page className=\"form\">\n      <h1>{ signup ? 'Sign Up' : 'Login' }</h1>\n\n      <Input\n        name=\"email\"\n        type=\"email\"\n        value={login.email}\n        validator={validators.email()}\n        onChange={setLogin}\n        />\n\n      <Input\n        name=\"password\"\n        type=\"password\"\n        value={login.password}\n        onChange={setLogin}\n        validator={validators.password()}\n        />\n\n        { error && <div className=\"error\">{error}</div> }\n\n      <button onClick={loginAction}>Submit</button>\n    </Page>\n  )\n}\n","import React from 'react'\nimport classNames from 'classnames'\n\nconst valueOnly = (fn) => ({ target }) => {\n  let { name, value } = target\n\n  if (name) {\n    return fn(target)\n  } else {\n    return fn(value)\n  }\n}\n\nexport default function Input({\n  name,\n  value,\n  onChange,\n  label,\n  placeholder,\n  className,\n  validator,\n  ...props\n}) {\n  let invalid = undefined\n  let validationMessage = undefined\n\n  if (validator) {\n    invalid = validator.isValid(value) ? undefined : 'true'\n    validationMessage = invalid && value && validator.message\n  }\n\n  return (\n    <section className=\"input-group\">\n      <input\n        className={classNames('input', className)}\n        type=\"text\"\n        name={name}\n        value={value}\n        invalid={invalid}\n        placeholder={placeholder || name}\n        onChange={valueOnly(onChange)}\n        {...props}\n        />\n      <label className={validationMessage ? 'hint' : undefined}>{ label || placeholder || name }</label>\n      {\n        validator && validator.message &&\n        <b className={classNames('details', validationMessage && 'visible')}>\n          { validationMessage }\n        </b>\n      }\n    </section>\n  )\n}\n","import React from 'react'\nimport { Link } from '@reach/router'\nimport List from './List'\nimport Page from '../Page'\nimport { useLogin, useStore, requireLogin } from '../../hooks'\n\nexport default function CollectionsList({ location }) {\n  let isLoggedIn = requireLogin(location)\n  let [ user ] = useStore('user')\n\n  if (!isLoggedIn) {\n    return false\n  }\n\n  let { collections } = user.profile\n\n  return (\n    <Page className=\"form collections-list\">\n      <h1>Collections</h1>\n      {\n        collections.map(c =>\n          <Link\n            key={c._id}\n            to={'/' + c.slug}\n          >\n            { c.name || c.slug }\n          </Link>\n        )\n      }\n      <Link className=\"create\" to=\"create\">Create New</Link>\n    </Page>\n  )\n}\n","import React, { useEffect } from 'react'\nimport { navigate } from '@reach/router'\nimport Page from '../Page'\nimport Input from '../Controls/Input'\nimport Inspect from '../Controls/Inspect'\nimport Back from '../Back'\nimport { validators } from '../../utils'\nimport { useNewCollection, requireLogin } from '../../hooks'\n\nexport default function CreateCollection({ location }) {\n  let isLoggedIn = requireLogin(location)\n  let collection = useNewCollection()\n  let {\n    slug,\n    setSlug,\n    apiKey,\n    setApiKey,\n    isAvailable,\n    isValid,\n    createCollectionAction,\n  } = collection\n\n  if (!isLoggedIn) {\n    return false\n  }\n\n  return (\n    <Page className=\"form\" visible={isLoggedIn}>\n      <h1>Create a New Collection</h1>\n\n      <Input\n        placeholder=\"Collection Link (URL)\"\n        value={slug}\n        validator={validators.collectionName(isAvailable)}\n        onChange={setSlug}\n        />\n\n      <Input\n        placeholder=\"Your API Key\"\n        value={apiKey}\n        onChange={setApiKey}\n        />\n\n      <button\n        disabled={!isValid}\n        onClick={createCollectionAction}\n      >\n        Create Collection\n      </button>\n    </Page>\n  )\n}\n","import React from 'react'\nimport { Link, navigate } from '@reach/router'\nimport { useStore, useLogin } from '../../hooks'\n\nexport default function UserActions({ location }) {\n  let origin = location && location.state && location.state.origin || undefined\n  let { user, logoutAction } = useLogin()\n\n  return (\n    <React.Fragment>\n      {\n        user.isLoggedIn\n        ? <React.Fragment>\n            <a className=\"link\" onClick={logoutAction}>Logout</a>\n            <Link to=\"/collections\">Collections</Link>\n          </React.Fragment>\n        : <div className=\"login-signup\">\n            <a\n              className=\"link\"\n              onClick={() =>\n                navigate('/login',\n                  {\n                    state: {\n                      origin: location && location.pathname\n                    },\n                    replace: true\n                  }\n                )\n              }>Login</a>\n            <Link to=\"/signup\">Signup</Link>\n          </div>\n      }\n    </React.Fragment>\n  )\n}\n"]}